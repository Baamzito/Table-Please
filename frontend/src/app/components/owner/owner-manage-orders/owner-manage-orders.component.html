<!-- Toast de nova encomenda -->
<div *ngIf="toastMessage" class="toast-container">
  <div class="toast-content">
    <i class="fas fa-bell me-2"></i>
    {{ toastMessage }}
    <button class="btn-close" (click)="toastMessage = null"></button>
  </div>
</div>


<section class="pt-5 mt-5 bg-light min-vh-100">
  <div class="container">
    <h2 class="mb-4">Manage Orders</h2>

    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status"></div>
    </div>

    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

    <div *ngIf="orders.length > 0">
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th scope="col">Order ID</th>
              <th scope="col">Customer</th>
              <th scope="col">Type</th>
              <th scope="col">Total</th>
              <th scope="col">Status</th>
              <th scope="col">Created At</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of orders">
              <td>{{ order._id }}</td>
              <td>{{ order.contact }}</td>
              <td>{{ order.type }}</td>
              <td>${{ order.totalPrice | number:'1.2-2' }}</td>
              <td>
                <span class="badge bg-info text-dark">{{ order.deliveryStatus }}</span>
              </td>
              <td>{{ order.createdAt | date:'short' }}</td>
              <td>
                <a [routerLink]="['/order', order._id]" class="btn btn-outline-primary btn-sm me-1">
                    <i class="fas fa-eye"></i> View
                </a>

                <button *ngIf="order.deliveryStatus === 'pending'" class="btn btn-success btn-sm me-1"
                    (click)="updateStatus(order._id, 'confirmed')">
                    <i class="fas fa-check"></i> Confirm
                </button>

                <button *ngIf="order.deliveryStatus === 'confirmed'" class="btn btn-warning btn-sm"
                    (click)="startPreparation(order)">
                    <i class="fas fa-hourglass-start"></i> Start Preparation
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div *ngIf="!loading && orders.length === 0" class="text-center py-5">
      <i class="fas fa-clipboard-list fa-3x text-muted mb-3"></i>
      <h5>No orders found for this restaurant.</h5>
    </div>
  </div>
</section>
